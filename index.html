<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <title>Conferência de Jogos Profissional</title>

    <style>
      body {
        font-family: Arial, sans-serif;
        background: #f2f2f2;
        padding: 20px;
      }

      .container {
        max-width: 1000px;
        margin: auto;
        background: #fff;
        padding: 20px;
        border-radius: 8px;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
      }

      h1 { text-align: center; color: #333; }

      .upload-section {
        background: #f8f9fa;
        padding: 15px;
        border: 2px dashed #ccc;
        border-radius: 8px;
        text-align: center;
        margin-bottom: 20px;
      }

      label {
        font-weight: bold;
        margin-top: 15px;
        display: block;
      }

      textarea, input[type="text"] {
        width: 100%;
        padding: 10px;
        margin-top: 5px;
        font-size: 14px;
        border-radius: 5px;
        border: 1px solid #ccc;
        box-sizing: border-box;
      }

      textarea { height: 150px; }

      .resumo {
        background: #e9ecef;
        padding: 15px;
        border-radius: 6px;
        margin-top: 15px;
        font-weight: bold;
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
      }

      .resumo-item {
        background: #fff;
        padding: 5px 10px;
        border-radius: 4px;
        border: 1px solid #ddd;
      }

      .categoria { margin-top: 20px; }
      .jogo {
        background: #f9f9f9;
        padding: 10px;
        border-radius: 6px;
        margin-bottom: 8px;
        border-left: 5px solid #ccc;
      }

      .acerto-alto { border-color: #4caf50; } 
      .acerto-baixo { border-color: #999; }

      .numero {
        display: inline-block;
        margin: 2px;
        padding: 6px 10px;
        border-radius: 50%;
        background: #e0e0e0;
        font-size: 13px;
        min-width: 20px;
        text-align: center;
      }

      .acertou {
        background: #4caf50;
        color: #fff;
        font-weight: bold;
      }

      .btn-import {
        background-color: #007bff;
        color: white;
        padding: 10px 20px;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        font-weight: bold;
      }
      
      .btn-import:hover { background-color: #0056b3; }
    </style>
  </head>

  <body>
    <div class="container">
      <h1>Conferência de Jogos</h1>
      
      <div class="upload-section">
        <p><strong>Importar Arquivo (.txt)</strong></p>
        <p><strong>formato esperado: 01,02,03,04,25 | 3589 | Efetivada | R$ 3,50</strong></p>
        <input type="file" id="arquivo_txt" accept=".txt" />
      </div>

      <label>Jogos Realizados (Formatado):</label>
      <textarea id="jogos" placeholder="Os jogos aparecerão aqui após importar ou digitar..."></textarea>

      <label>Números sorteados (Separe por vírgula):</label>
      <input type="text" id="sorteados" placeholder="Ex: 01,02,03,04,05,06,07,08,09,10,11,12,13,14,15" />

      <div id="resultado"></div>
    </div>

    <script>
      const jogosEl = document.getElementById("jogos");
      const sorteadosEl = document.getElementById("sorteados");
      const resultadoEl = document.getElementById("resultado");
      const arquivoInput = document.getElementById("arquivo_txt");

      // Evento para ler o arquivo enviado
      arquivoInput.addEventListener("change", function(e) {
        const arquivo = e.target.files[0];
        if (!arquivo) return;

        const leitor = new FileReader();
        leitor.onload = function(e) {
          const conteudo = e.target.result;
          const linhas = conteudo.split("\n");
          
          // Filtra apenas a parte antes do "|" e limpa espaços
          const jogosFormatados = linhas
            .map(linha => {
              const parteNumeros = linha.split("|")[0]; // Pega tudo antes do |
              return parteNumeros.trim();
            })
            .filter(linha => linha.length > 0) // Remove linhas vazias
            .join("\n");

          jogosEl.value = jogosFormatados;
          conferir(); // Atualiza a conferência automaticamente
        };
        leitor.readAsText(arquivo);
      });

      jogosEl.addEventListener("input", conferir);
      sorteadosEl.addEventListener("input", conferir);

      function conferir() {
        const txtJogos = jogosEl.value.trim();
        const txtSorteados = sorteadosEl.value.trim();

        if (!txtJogos || !txtSorteados) {
          resultadoEl.innerHTML = "";
          return;
        }

        const sorteados = txtSorteados.split(/[\s,]+/).map(n => n.padStart(2, '0')).filter(n => n);
        const maxPossivel = sorteados.length;
        
        const jogos = txtJogos.split("\n").map(linha => {
          return linha.split(/[\s,]+/).map(n => n.padStart(2, '0')).filter(n => n && !isNaN(n));
        }).filter(j => j.length > 0);

        let grupos = {};
        for(let i = 0; i <= maxPossivel; i++) grupos[i] = [];

        jogos.forEach((jogo, index) => {
          const acertosNoJogo = jogo.filter(n => sorteados.includes(n));
          const qtd = acertosNoJogo.length;
          if (grupos[qtd]) grupos[qtd].push({ jogo, acertosNoJogo, index });
        });

        // Resumo
        let resumoHTML = `<div class="resumo"><strong>Total: ${jogos.length} jogos</strong>`;
        for (let i = maxPossivel; i >= 0; i--) {
            if (grupos[i].length > 0) {
                resumoHTML += `<span class="resumo-item">${i} acertos: ${grupos[i].length}</span>`;
            }
        }
        resumoHTML += `</div>`;

        // Lista
        let listaHTML = "";
        for (let i = maxPossivel; i >= 0; i--) {
          if (grupos[i].length === 0) continue;

          let corClasse = (i >= 11 || (i >= 4 && maxPossivel === 6)) ? "acerto-alto" : "acerto-baixo";

          listaHTML += `
            <div class="categoria">
              <h3>${i} acerto${i !== 1 ? "s" : ""}</h3>
              ${grupos[i].map(item => `
                  <div class="jogo ${corClasse}">
                    <strong>Jogo ${item.index + 1}</strong><br>
                    ${item.jogo.map(n => 
                        item.acertosNoJogo.includes(n) 
                        ? `<span class="numero acertou">${n}</span>` 
                        : `<span class="numero">${n}</span>`
                    ).join("")}
                  </div>
              `).join("")}
            </div>`;
        }
        resultadoEl.innerHTML = resumoHTML + listaHTML;
      }
    </script>
  </body>
</html>

